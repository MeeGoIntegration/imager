{% extends 'base.html' %}

{% block pagetitle %}IMG image uploader{% endblock %}

{% block title %}IMG image uploader{% endblock %}

{% block content %}
<script type="text/javascript">
    $(function() {
        $('#id_extra_repos_table tbody tr').formset({
            extraClasses: ['row1', 'row2', 'row3']
        });
        $('#ksfile').attr("checked","checked");
        $('#id_template').attr("disabled","disabled");
        $('#ksfile , #template').change(function(e){
            var enid = '' + $(e.target).attr('id');
            var dissel = 'input:radio:not([id=' + enid + '])';
            var disid = $(dissel).attr('id');
            $('#id_'+enid).removeAttr("disabled");
            $('#id_'+disid).attr("disabled","disabled");
        });
        $("#uploadform").submit( function () {
           $('#id_ksfile , #id_template').each(function(){ $(this).removeAttr("disabled")});
           return true; 
        } );
    })
</script>
{% if formerror %}
<div class="errors">
  {% for label, errors in formerror.items %}
    {{ label }} : {{ errors|join:", " }}
  {% endfor %}
</div>
{% endif%}
<form id="uploadform" action="{%url img-app-submit%}" method="post" enctype="multipart/form-data">
    {% csrf_token %}
    <table width="100%">
    {% for field in form %}
        <tr>
            <td>
            {% if field.name == "ksfile" or field.name == "template"%}
              <input type="radio" name="choice" id="{{ field.name }}"/>
            {% endif %}
            {{ field.label_tag }} 
            </td>
            <td>
            {{ field }}
            </td>
        </tr>
        {% if field.name == "ksfile" %}
        <tr border="15px">
        <td>-OR-</td>
        <td></td>
        </tr>
        {% endif %}
    {% endfor %}
    </table>
    <table id="id_extra_repos_table" border="0" cellpadding="0" cellspacing="5">
         <thead>
             <tr>
                 <th scope="col">OBS</th>
                 <th scope="col">Repository</th>
             </tr>
         </thead>
         <tbody>
             {% for f in formset.forms %}
             <tr id="{{ f.prefix }}-row">
                 <td>{{ f.obs }}</td>
                 <td>{{ f.repo }}</td>
             </tr>
             {% endfor %}
         </tbody>
     </table>
    {{ formset.management_form }}
<p><input type="submit" value="Submit" /></p>
</form>

{% endblock %}
{% block sidebar_title %}
Help
{% endblock %}
{% block sidebar_content %}
    {% for field in form %}
    <li>{{ field.help_text }}</li>
    {% endfor %}
    {% for f in formset.forms %}
      {% for field in f %}
        <li>{{ field.help_text }}</li>
      {% endfor %}
    {% endfor %}
{% endblock %}
